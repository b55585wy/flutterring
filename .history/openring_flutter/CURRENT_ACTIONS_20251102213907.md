# ğŸ¯ ç§‘ç ”ç‰ˆå½“å‰è¡ŒåŠ¨æ¸…å•

**æ—¥æœŸ**: 2025-10-30  
**ç›®æ ‡**: å°†å½“å‰ UI è°ƒæ•´ä¸ºç§‘ç ”ç‰ˆå®šä½

---

## ğŸ“‹ ç«‹å³è°ƒæ•´é¡¹ï¼ˆæœ¬å‘¨ï¼‰

### 1ï¸âƒ£ **ä¸»é¡µ (home_page.dart) - ç§»é™¤è£…é¥°æ€§å…ƒç´ **

#### **ç§»é™¤:**
```dart
// âŒ åˆ é™¤æ¸å˜æ¬¢è¿å¡ç‰‡
Container(
  decoration: BoxDecoration(
    gradient: LinearGradient(...),
  ),
  child: Column(
    children: [
      Text('æ—©ä¸Šå¥½ï¼'), // â† ä¸éœ€è¦
      Text('å¼€å§‹ä»Šå¤©çš„å¥åº·ç›‘æµ‹'), // â† å¤ªæ¶ˆè´¹åŒ–
    ],
  ),
)
```

#### **æ›¿æ¢ä¸º:**
```dart
// âœ… è®¾å¤‡çŠ¶æ€ä¿¡æ¯å¡ç‰‡
Card(
  child: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text('è®¾å¤‡çŠ¶æ€', style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),
      SizedBox(height: 12),
      
      // è®¾å¤‡ä¿¡æ¯
      _buildInfoRow('è®¾å¤‡åç§°', 'Ring-A1B2C3'),
      _buildInfoRow('MAC åœ°å€', '00:11:22:33:44:55'),
      _buildInfoRow('å›ºä»¶ç‰ˆæœ¬', 'v1.0.81'),
      _buildInfoRow('ç”µæ± ç”µé‡', '78%'),
      _buildInfoRow('è¿æ¥çŠ¶æ€', isConnected ? 'å·²è¿æ¥' : 'æœªè¿æ¥',
        valueColor: isConnected ? Colors.green : Colors.red),
    ],
  ),
)

Widget _buildInfoRow(String label, String value, {Color? valueColor}) {
  return Padding(
    padding: const EdgeInsets.symmetric(vertical: 4),
    child: Row(
      mainAxisAlignment: MainAxisAlignment.spaceBetween,
      children: [
        Text(label, style: TextStyle(color: Colors.grey[600])),
        Text(value, style: TextStyle(
          fontWeight: FontWeight.w500,
          color: valueColor,
        )),
      ],
    ),
  );
}
```

#### **æ·»åŠ : æœ€è¿‘å®éªŒåˆ—è¡¨**
```dart
Card(
  child: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text('æœ€è¿‘å®éªŒ', style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),
      SizedBox(height: 12),
      
      ListView.separated(
        shrinkWrap: true,
        physics: NeverScrollableScrollPhysics(),
        itemCount: 5,
        separatorBuilder: (_, __) => Divider(),
        itemBuilder: (context, index) {
          return ListTile(
            dense: true,
            leading: Icon(Icons.file_present, color: Colors.blue),
            title: Text('2025-10-30 14:23:15'),
            subtitle: Text('æ—¶é•¿: 5:32 | å¤§å°: 2.3 MB'),
            trailing: Icon(Icons.chevron_right),
          );
        },
      ),
    ],
  ),
)
```

---

### 2ï¸âƒ£ **æµ‹é‡é¡µ (measurement_page.dart) - ä¸“ä¸šåŒ–è°ƒæ•´**

#### **ç§»é™¤:**
```dart
// âŒ åˆ é™¤å¿ƒè·³åŠ¨ç”»
ScaleTransition(
  scale: _heartbeatAnimation,
  child: Icon(Icons.favorite, color: Colors.red, size: 32),
)
```

#### **æ›¿æ¢ä¸º:**
```dart
// âœ… é™æ€å›¾æ ‡ + æ•°æ®è´¨é‡æŒ‡ç¤ºå™¨
Row(
  children: [
    Icon(Icons.favorite, color: Colors.red, size: 24),
    SizedBox(width: 8),
    Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Text('72 BPM', style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold)),
        Text('ç½®ä¿¡åº¦: 95%', style: TextStyle(fontSize: 12, color: Colors.grey)),
      ],
    ),
  ],
)
```

#### **æ·»åŠ : é€šé“é€‰æ‹©å™¨**
```dart
// åœ¨æ³¢å½¢å›¾ä¸Šæ–¹æ·»åŠ 
Wrap(
  spacing: 8,
  children: [
    FilterChip(
      label: Text('PPG Green'),
      selected: _selectedChannels.contains('ppg_green'),
      onSelected: (selected) {
        setState(() {
          if (selected) {
            _selectedChannels.add('ppg_green');
          } else {
            _selectedChannels.remove('ppg_green');
          }
        });
      },
      selectedColor: Colors.green.withOpacity(0.3),
    ),
    FilterChip(
      label: Text('PPG Red'),
      selected: _selectedChannels.contains('ppg_red'),
      onSelected: (selected) { /* ... */ },
      selectedColor: Colors.red.withOpacity(0.3),
    ),
    FilterChip(
      label: Text('PPG IR'),
      selected: _selectedChannels.contains('ppg_ir'),
      onSelected: (selected) { /* ... */ },
      selectedColor: Colors.orange.withOpacity(0.3),
    ),
    FilterChip(label: Text('ACC X'), /* ... */),
    FilterChip(label: Text('ACC Y'), /* ... */),
    FilterChip(label: Text('ACC Z'), /* ... */),
    // ... å…¶ä»–é€šé“
  ],
)
```

#### **æ·»åŠ : å®æ—¶ç»Ÿè®¡é¢æ¿**
```dart
// åœ¨ç”Ÿç†æŒ‡æ ‡ä¸‹æ–¹æ·»åŠ 
Card(
  color: Colors.grey[100],
  child: Padding(
    padding: EdgeInsets.all(12),
    child: Row(
      mainAxisAlignment: MainAxisAlignment.spaceAround,
      children: [
        _buildStatItem('é‡‡æ ·ç‡', '25 Hz'),
        _buildStatItem('å·²é‡‡æ ·', '2048'),
        _buildStatItem('æ—¶é•¿', '01:22'),
        _buildStatItem('ä¸¢åŒ…', '0.1%'),
      ],
    ),
  ),
)

Widget _buildStatItem(String label, String value) {
  return Column(
    children: [
      Text(value, style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold)),
      Text(label, style: TextStyle(fontSize: 12, color: Colors.grey[600])),
    ],
  );
}
```

#### **æ·»åŠ : æ³¢å½¢æ§åˆ¶å·¥å…·æ **
```dart
Row(
  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
  children: [
    IconButton(
      icon: Icon(Icons.zoom_in),
      onPressed: () {/* ç¼©æ”¾æ³¢å½¢ */},
      tooltip: 'Yè½´æ”¾å¤§',
    ),
    IconButton(
      icon: Icon(Icons.zoom_out),
      onPressed: () {/* ç¼©æ”¾æ³¢å½¢ */},
      tooltip: 'Yè½´ç¼©å°',
    ),
    IconButton(
      icon: Icon(Icons.pause),
      onPressed: () {/* æš‚åœåˆ·æ–° */},
      tooltip: 'æš‚åœåˆ·æ–°',
    ),
    IconButton(
      icon: Icon(Icons.bookmark_add),
      onPressed: () {/* æ·»åŠ æ ‡æ³¨ */},
      tooltip: 'æ·»åŠ æ ‡æ³¨',
    ),
  ],
)
```

---

### 3ï¸âƒ£ **å†å²é¡µ (history_page.dart) - è¯¦ç»†ä¿¡æ¯**

#### **å¢å¼ºè®°å½•åˆ—è¡¨:**
```dart
ListTile(
  leading: Icon(Icons.file_present),
  title: Text('2025-10-30 14:23:15'),
  subtitle: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text('æ—¶é•¿: 5:32 | é‡‡æ ·: 8320 ç‚¹'),
      Text('HR: 68-76 BPM | RR: 14-18 RPM'),
      Text('ä¿¡å·è´¨é‡: ä¼˜ç§€ (98%) | æ–‡ä»¶: 2.3 MB'),
    ],
  ),
  trailing: PopupMenuButton(
    itemBuilder: (context) => [
      PopupMenuItem(child: Text('æŸ¥çœ‹è¯¦æƒ…')),
      PopupMenuItem(child: Text('å¯¼å‡º CSV')),
      PopupMenuItem(child: Text('åˆ é™¤')),
    ],
  ),
)
```

#### **æ·»åŠ æ‰¹é‡æ“ä½œ:**
```dart
// é¡¶éƒ¨æ·»åŠ 
Row(
  children: [
    Checkbox(
      value: _selectAll,
      onChanged: (value) {
        setState(() {
          _selectAll = value ?? false;
          // å…¨é€‰/å–æ¶ˆå…¨é€‰
        });
      },
    ),
    Text('å…¨é€‰'),
    Spacer(),
    if (_selectedRecords.isNotEmpty) ...[
      TextButton.icon(
        icon: Icon(Icons.file_download),
        label: Text('æ‰¹é‡å¯¼å‡º (${_selectedRecords.length})'),
        onPressed: () {/* æ‰¹é‡å¯¼å‡º */},
      ),
      TextButton.icon(
        icon: Icon(Icons.delete),
        label: Text('æ‰¹é‡åˆ é™¤'),
        onPressed: () {/* æ‰¹é‡åˆ é™¤ */},
        style: TextButton.styleFrom(foregroundColor: Colors.red),
      ),
    ],
  ],
)
```

---

### 4ï¸âƒ£ **è®¾ç½®é¡µ (settings_page.dart) - ç§‘ç ”ä¸“ç”¨è®¾ç½®**

#### **æ·»åŠ ç®—æ³•å‚æ•°åˆ†ç»„:**
```dart
_buildSettingGroup(
  'ç®—æ³•å‚æ•°',
  [
    ListTile(
      leading: Icon(Icons.tune, color: Colors.blue),
      title: Text('å¿ƒç‡è®¡ç®—çª—å£'),
      subtitle: Text('å½“å‰: 8 ç§’'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // æ‰“å¼€å‚æ•°è°ƒèŠ‚å¯¹è¯æ¡†
        _showParameterDialog('HR Window', 8, 1, 30);
      },
    ),
    ListTile(
      leading: Icon(Icons.tune, color: Colors.green),
      title: Text('å‘¼å¸ç‡è®¡ç®—çª—å£'),
      subtitle: Text('å½“å‰: 30 ç§’'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        _showParameterDialog('RR Window', 30, 10, 60);
      },
    ),
    ListTile(
      leading: Icon(Icons.tune, color: Colors.orange),
      title: Text('å³°å€¼æ£€æµ‹é˜ˆå€¼'),
      subtitle: Text('å½“å‰: 0.6'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        _showParameterDialog('Peak Threshold', 0.6, 0.1, 1.0);
      },
    ),
  ],
),
```

#### **æ·»åŠ å¯¼å‡ºè®¾ç½®åˆ†ç»„:**
```dart
_buildSettingGroup(
  'å¯¼å‡ºè®¾ç½®',
  [
    ListTile(
      leading: Icon(Icons.text_fields, color: Colors.purple),
      title: Text('CSV åˆ†éš”ç¬¦'),
      subtitle: Text('å½“å‰: é€—å·'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // é€‰æ‹©åˆ†éš”ç¬¦ï¼ˆé€—å·/åˆ¶è¡¨ç¬¦/åˆ†å·ï¼‰
      },
    ),
    ListTile(
      leading: Icon(Icons.access_time, color: Colors.teal),
      title: Text('æ—¶é—´æˆ³æ ¼å¼'),
      subtitle: Text('å½“å‰: Unix (æ¯«ç§’)'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // é€‰æ‹©æ—¶é—´æˆ³æ ¼å¼
      },
    ),
    ListTile(
      leading: Icon(Icons.format_list_numbered, color: Colors.indigo),
      title: Text('æ•°å€¼ç²¾åº¦'),
      subtitle: Text('å½“å‰: ä¿ç•™ 3 ä½å°æ•°'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // é€‰æ‹©å°æ•°ä½æ•°
      },
    ),
  ],
),
```

#### **æ·»åŠ å®éªŒç®¡ç†åˆ†ç»„:**
```dart
_buildSettingGroup(
  'å®éªŒç®¡ç†',
  [
    ListTile(
      leading: Icon(Icons.person, color: Colors.green),
      title: Text('å—è¯•è€…ä¿¡æ¯æ¨¡æ¿'),
      subtitle: Text('è®¾ç½®é»˜è®¤å­—æ®µ'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // æ‰“å¼€æ¨¡æ¿ç¼–è¾‘å™¨
      },
    ),
    ListTile(
      leading: Icon(Icons.science, color: Colors.blue),
      title: Text('å®éªŒé¡¹ç›®ç®¡ç†'),
      subtitle: Text('åˆ›å»ºå’Œç®¡ç†å®éªŒ'),
      trailing: Icon(Icons.chevron_right),
      onTap: () {
        // æ‰“å¼€é¡¹ç›®ç®¡ç†é¡µé¢
      },
    ),
  ],
),
```

---

## ğŸ¨ UI é€šç”¨è°ƒæ•´

### **å‡å°é—´è·ï¼Œå¢åŠ ä¿¡æ¯å¯†åº¦**

```dart
// å…¨å±€è°ƒæ•´ padding
- const EdgeInsets.all(24)
+ const EdgeInsets.all(12)

- const EdgeInsets.symmetric(horizontal: 20, vertical: 16)
+ const EdgeInsets.symmetric(horizontal: 12, vertical: 8)
```

### **ä½¿ç”¨æ›´ä¸“ä¸šçš„é…è‰²**

```dart
// å‡å°‘æ¸å˜ï¼Œä½¿ç”¨çº¯è‰²
- Container(decoration: BoxDecoration(gradient: LinearGradient(...)))
+ Container(color: Colors.grey[50])

// å‡å°‘åœ†è§’
- BorderRadius.circular(20)
+ BorderRadius.circular(8)

// å‡å°‘é˜´å½±
- boxShadow: [BoxShadow(blurRadius: 20, ...)]
+ boxShadow: [BoxShadow(blurRadius: 4, spreadRadius: 1, ...)]
```

---

## ğŸ“Š ä¸‹å‘¨å¼€å‘ï¼ˆæ–°åŠŸèƒ½ï¼‰

### 1. **CSV å¯¼å‡ºåŠŸèƒ½**
```dart
// lib/services/csv_exporter.dart
class CSVExporter {
  Future<String> exportMeasurement(Measurement measurement) async {
    // ç”Ÿæˆ CSV æ–‡ä»¶
    // åŒ…å«ï¼šæ—¶é—´æˆ³ã€12 é€šé“æ•°æ®ã€HRã€RRã€è´¨é‡
  }
  
  Future<void> exportBatch(List<Measurement> measurements) async {
    // æ‰¹é‡å¯¼å‡º
  }
}
```

### 2. **é€šé“æ•°æ®ç®¡ç†**
```dart
// lib/models/channel_data.dart
enum ChannelType {
  ppgGreen, ppgRed, ppgIr,
  accX, accY, accZ,
  gyroX, gyroY, gyroZ,
  temp0, temp1, temp2,
}

class ChannelBuffer {
  final ChannelType type;
  final List<double> data;
  final int maxSize;
  
  void addSample(double value) {
    data.add(value);
    if (data.length > maxSize) {
      data.removeAt(0);
    }
  }
}
```

### 3. **æ³¢å½¢æ ‡æ³¨åŠŸèƒ½**
```dart
// lib/models/annotation.dart
class WaveformAnnotation {
  final DateTime timestamp;
  final int sampleIndex;
  final String label;
  final AnnotationType type;
  final String? notes;
}

enum AnnotationType {
  eventStart,
  eventEnd,
  anomaly,
  manual,
}
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### **æœ¬å‘¨å®Œæˆååº”è¯¥çœ‹åˆ°:**

1. âœ… ä¸»é¡µæ˜¾ç¤ºè®¾å¤‡è¯¦ç»†ä¿¡æ¯ï¼ˆMACã€ç‰ˆæœ¬ã€ç”µé‡ï¼‰
2. âœ… ä¸»é¡µæ˜¾ç¤ºæœ€è¿‘ 5 æ¬¡å®éªŒè®°å½•
3. âœ… æµ‹é‡é¡µç§»é™¤å¿ƒè·³åŠ¨ç”»ï¼Œæ”¹ä¸ºé™æ€ + ç½®ä¿¡åº¦
4. âœ… æµ‹é‡é¡µæœ‰é€šé“é€‰æ‹©å™¨ï¼ˆè‡³å°‘ 6 ä¸ªé€šé“ï¼‰
5. âœ… æµ‹é‡é¡µæœ‰å®æ—¶ç»Ÿè®¡é¢æ¿ï¼ˆé‡‡æ ·ç‡ã€æ•°é‡ã€æ—¶é•¿ã€ä¸¢åŒ…ï¼‰
6. âœ… æµ‹é‡é¡µæœ‰æ³¢å½¢æ§åˆ¶å·¥å…·æ ï¼ˆç¼©æ”¾ã€æš‚åœã€æ ‡æ³¨æŒ‰é’®ï¼‰
7. âœ… å†å²é¡µæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆé‡‡æ ·ç‚¹æ•°ã€HR/RR èŒƒå›´ã€æ–‡ä»¶å¤§å°ï¼‰
8. âœ… å†å²é¡µæœ‰æ‰¹é‡æ“ä½œï¼ˆå…¨é€‰ã€æ‰¹é‡å¯¼å‡ºã€æ‰¹é‡åˆ é™¤ï¼‰
9. âœ… è®¾ç½®é¡µæœ‰ç®—æ³•å‚æ•°åˆ†ç»„ï¼ˆ3 ä¸ªå‚æ•°ï¼‰
10. âœ… è®¾ç½®é¡µæœ‰å¯¼å‡ºè®¾ç½®åˆ†ç»„ï¼ˆ3 ä¸ªé€‰é¡¹ï¼‰
11. âœ… è®¾ç½®é¡µæœ‰å®éªŒç®¡ç†åˆ†ç»„ï¼ˆ2 ä¸ªåŠŸèƒ½ï¼‰

### **æ•´ä½“æ•ˆæœ:**
- ä¿¡æ¯å¯†åº¦æå‡ 50%ï¼ˆæ›´å¤šæ–‡æœ¬ä¿¡æ¯ï¼Œæ›´å°‘è£…é¥°ï¼‰
- ä¸“ä¸šæ„Ÿå¢å¼ºï¼ˆæŠ€æœ¯å‚æ•°å¯è§ï¼‰
- å·¥å…·æ€§çªå‡ºï¼ˆæ§åˆ¶æŒ‰é’®ã€æ‰¹é‡æ“ä½œï¼‰

---

## ğŸš€ å¼€å§‹è°ƒæ•´

### **å»ºè®®é¡ºåº:**

1. **ä»Šå¤©**: è°ƒæ•´ä¸»é¡µï¼ˆç§»é™¤æ¬¢è¿å¡ç‰‡ï¼Œæ·»åŠ è®¾å¤‡çŠ¶æ€ï¼‰
2. **æ˜å¤©**: è°ƒæ•´æµ‹é‡é¡µï¼ˆç§»é™¤åŠ¨ç”»ï¼Œæ·»åŠ ç»Ÿè®¡é¢æ¿ï¼‰
3. **åå¤©**: è°ƒæ•´æµ‹é‡é¡µï¼ˆæ·»åŠ é€šé“é€‰æ‹©å™¨å’Œå·¥å…·æ ï¼‰
4. **å‘¨å››**: è°ƒæ•´å†å²é¡µï¼ˆè¯¦ç»†ä¿¡æ¯å’Œæ‰¹é‡æ“ä½œï¼‰
5. **å‘¨äº”**: è°ƒæ•´è®¾ç½®é¡µï¼ˆç§‘ç ”ä¸“ç”¨è®¾ç½®ï¼‰

---

**ä»æ¶ˆè´¹çº§ UI å‡çº§ä¸ºç§‘ç ”çº§å·¥å…·ï¼** ğŸ”¬







